---
title: "homework1"
format: html
---

###Problem 1
*a.* Import the data into a data.frame in R. Use the information in the “abalone.names” file to give appropriate column names.
```{r}
data <- read.csv("abalone/abalone.data")
abalone <- data.frame(data)
abalone_name <- c("Sex", "Length",	"Diam",	"Height",	"Whole",	"Shucked", "Viscera",	"Shell", "Rings")
colnames(abalone) <- abalone_name
head(abalone)
```

*b.* The data contains information on three different sexes of abalone. Report the number of observations belonging to each sex.
```{r}
table(abalone$Sex)
```

*c.* Use the data to answer the following questions:
  **1.** Which weight has the highest correlation with rings?
```{r}
weights_rings <- c("Whole",	"Shucked", "Viscera",	"Shell",'Rings')
#chatgpt helped me with how to calculate correlations in R
correlations <- cor(abalone[, weights_rings])[, 'Rings']
#to drop the self-correlated column
correlations <- correlations[names(correlations) != "Rings"]
correlations
which.max(correlations)
```
  From the table above we can see that Shell weight has the higest correlation with rings
  
  **2.** For that weight, which sex has the highest correlation?
```{r}
#this code is modified by chatgpt
library(dplyr)
shell_corr <- abalone %>%
  group_by(Sex) %>%
  summarise(correlation = cor(Shell, Rings))
shell_corr
```
From the table above, the sex I (infant) has the largest correlatin with rings  
  
  **3.** What are the weights of the abalone with the most rings?
```{r}
most_rings <- max(abalone$Rings)
weights <- c("Whole",	"Shucked", "Viscera",	"Shell")
most_rings_weights <- abalone[abalone$Rings == most_rings, weights]
most_rings_weights
```
  **4.** What percentage of abalones have a viscera weight larger than their shell weight?
  
```{r}
percentage <- mean(abalone$Viscera > abalone$Shell)*100
percentage

```
6.51341% of abalones have a viscera weight larger than their shell weight.

*d.* Create a table of correlations between weights and rings, within each sex. The columns should be the four weights, and the rows should be the sexes. 
```{r}
#this code is modified by chatgpt
corr_table <- abalone %>%
  group_by(Sex) %>%
  summarise(
    across(
    all_of(weights),
    ~ cor(.x, Rings),
    .names = "{.col}")
  )
corr_table
```

*e.* Carry out a series of t-tests to examine whether the number of rings differs across the three sexes. Present the R output and interpret the results. 
```{r}
#I consulted chatgpt for the existing R function that can calculate t-test
pairwise.t.test(abalone$Rings, abalone$Sex)
```
Since all p values are less than 0.05, we can say that they are all statisically significance. Thus the number of rings do differ across the three sexes


